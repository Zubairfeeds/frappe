(()=>{(function(l,e){var o,t,r,n;e.__SV||(window.posthog=e,e._i=[],e.init=function(g,h,s){function u(p,i){var c=i.split(".");c.length==2&&(p=p[c[0]],i=c[1]),p[i]=function(){p.push([i].concat(Array.prototype.slice.call(arguments,0)))}}(r=l.createElement("script")).type="text/javascript",r.async=!0,r.src=h.api_host+"/static/array.js",(n=l.getElementsByTagName("script")[0]).parentNode.insertBefore(r,n);var a=e;for(s!==void 0?a=e[s]=[]:s="posthog",a.people=a.people||[],a.toString=function(p){var i="posthog";return s!=="posthog"&&(i+="."+s),p||(i+=" (stub)"),i},a.people.toString=function(){return a.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags".split(" "),t=0;t<o.length;t++)u(a,o[t]);e._i.push([g,h,s])},e.__SV=1)})(document,window.posthog||[]);var _=class{constructor(){this.enabled=!1,this.project_id=frappe.boot.posthog_project_id,this.telemetry_host=frappe.boot.posthog_host,this.site_age=frappe.boot.telemetry_site_age,cint(frappe.boot.enable_telemetry)&&this.project_id&&this.telemetry_host&&(this.enabled=!0)}initialize(){if(!!this.enabled)try{posthog.init(this.project_id,{api_host:this.telemetry_host,autocapture:!1,capture_pageview:!1,capture_pageleave:!1,advanced_disable_decide:!0}),posthog.identify(frappe.boot.sitename),this.send_heartbeat(),this.register_pageview_handler()}catch(e){console.trace("Failed to initialize telemetry",e),this.enabled=!1}}capture(e,o,t){!this.enabled||posthog.capture(`${o}_${e}`,t)}disable(){this.enabled=!1,posthog.opt_out_capturing()}send_heartbeat(){var r,n;let e="ph_last_heartbeat",o=frappe.datetime.system_datetime(!0),t=localStorage.getItem(e);(!t||moment(o).diff(moment(t),"hours")>12)&&(localStorage.setItem(e,o.toISOString()),this.capture("heartbeat","frappe",{frappe_version:(n=(r=frappe.boot)==null?void 0:r.versions)==null?void 0:n.frappe}))}register_pageview_handler(){this.site_age&&this.site_age>5||frappe.router.on("change",()=>{posthog.capture("$pageview")})}};frappe.telemetry=new _;frappe.telemetry.initialize();})();
//# sourceMappingURL=telemetry.bundle.ESRPVZ24.js.map

{
  "version": 3,
  "sources": ["../../../../../apps/frappe/frappe/public/js/lib/posthog.js", "../../../../../apps/frappe/frappe/public/js/telemetry/index.js"],
  "sourcesContent": ["!function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(\".\");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement(\"script\")).type=\"text/javascript\",p.async=!0,p.src=s.api_host+\"/static/array.js\",(r=t.getElementsByTagName(\"script\")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a=\"posthog\",u.people=u.people||[],u.toString=function(t){var e=\"posthog\";return\"posthog\"!==a&&(e+=\".\"+a),t||(e+=\" (stub)\"),e},u.people.toString=function(){return u.toString(1)+\".people (stub)\"},o=\"capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags\".split(\" \"),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);\n", "import \"../lib/posthog.js\";\n\nclass TelemetryManager {\n\tconstructor() {\n\t\tthis.enabled = false;\n\n\t\tthis.project_id = frappe.boot.posthog_project_id;\n\t\tthis.telemetry_host = frappe.boot.posthog_host;\n\t\tthis.site_age = frappe.boot.telemetry_site_age;\n\n\t\tif (cint(frappe.boot.enable_telemetry) && this.project_id && this.telemetry_host) {\n\t\t\tthis.enabled = true;\n\t\t}\n\t}\n\n\tinitialize() {\n\t\tif (!this.enabled) return;\n\t\ttry {\n\t\t\tposthog.init(this.project_id, {\n\t\t\t\tapi_host: this.telemetry_host,\n\t\t\t\tautocapture: false,\n\t\t\t\tcapture_pageview: false,\n\t\t\t\tcapture_pageleave: false,\n\t\t\t\tadvanced_disable_decide: true,\n\t\t\t});\n\t\t\tposthog.identify(frappe.boot.sitename);\n\t\t\tthis.send_heartbeat();\n\t\t\tthis.register_pageview_handler();\n\t\t} catch (e) {\n\t\t\tconsole.trace(\"Failed to initialize telemetry\", e);\n\t\t\tthis.enabled = false;\n\t\t}\n\t}\n\n\tcapture(event, app, props) {\n\t\tif (!this.enabled) return;\n\t\tposthog.capture(`${app}_${event}`, props);\n\t}\n\n\tdisable() {\n\t\tthis.enabled = false;\n\t\tposthog.opt_out_capturing();\n\t}\n\n\tsend_heartbeat() {\n\t\tconst KEY = \"ph_last_heartbeat\";\n\t\tconst now = frappe.datetime.system_datetime(true);\n\t\tconst last = localStorage.getItem(KEY);\n\n\t\tif (!last || moment(now).diff(moment(last), \"hours\") > 12) {\n\t\t\tlocalStorage.setItem(KEY, now.toISOString());\n\t\t\tthis.capture(\"heartbeat\", \"frappe\", { frappe_version: frappe.boot?.versions?.frappe });\n\t\t}\n\t}\n\n\tregister_pageview_handler() {\n\t\tif (this.site_age && this.site_age > 5) {\n\t\t\treturn;\n\t\t}\n\n\t\tfrappe.router.on(\"change\", () => {\n\t\t\tposthog.capture(\"$pageview\");\n\t\t});\n\t}\n}\n\nfrappe.telemetry = new TelemetryManager();\nfrappe.telemetry.initialize();\n"],
  "mappings": "MAAA,AAAC,UAAS,EAAE,EAAE,CAAC,GAAI,GAAE,EAAE,EAAE,EAAE,EAAE,MAAO,QAAO,QAAQ,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,KAAK,SAAS,EAAE,EAAE,EAAE,CAAC,WAAW,EAAE,EAAE,CAAC,GAAI,GAAE,EAAE,MAAM,GAAG,EAAE,AAAG,EAAE,QAAL,GAAc,GAAE,EAAE,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,GAAG,UAAU,CAAC,EAAE,KAAK,CAAC,CAAC,EAAE,OAAO,MAAM,UAAU,MAAM,KAAK,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,AAAC,GAAE,EAAE,cAAc,QAAQ,GAAG,KAAK,kBAAkB,EAAE,MAAM,GAAG,EAAE,IAAI,EAAE,SAAS,mBAAoB,GAAE,EAAE,qBAAqB,QAAQ,EAAE,IAAI,WAAW,aAAa,EAAE,CAAC,EAAE,GAAI,GAAE,EAAE,IAAI,AAAS,IAAT,OAAW,EAAE,EAAE,GAAG,CAAC,EAAE,EAAE,UAAU,EAAE,OAAO,EAAE,QAAQ,CAAC,EAAE,EAAE,SAAS,SAAS,EAAE,CAAC,GAAI,GAAE,UAAU,MAAM,AAAY,KAAZ,WAAgB,IAAG,IAAI,GAAG,GAAI,IAAG,WAAW,CAAC,EAAE,EAAE,OAAO,SAAS,UAAU,CAAC,MAAO,GAAE,SAAS,CAAC,EAAE,gBAAgB,EAAE,EAAE,kMAAkM,MAAM,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,OAAO,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,KAAK,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,KAAK,EAAE,GAAE,SAAS,OAAO,SAAS,CAAC,CAAC,ECEt5B,WAAuB,CACtB,aAAc,CACb,KAAK,QAAU,GAEf,KAAK,WAAa,OAAO,KAAK,mBAC9B,KAAK,eAAiB,OAAO,KAAK,aAClC,KAAK,SAAW,OAAO,KAAK,mBAExB,KAAK,OAAO,KAAK,gBAAgB,GAAK,KAAK,YAAc,KAAK,gBACjE,MAAK,QAAU,GAEjB,CAEA,YAAa,CACZ,GAAI,EAAC,KAAK,QACV,GAAI,CACH,QAAQ,KAAK,KAAK,WAAY,CAC7B,SAAU,KAAK,eACf,YAAa,GACb,iBAAkB,GAClB,kBAAmB,GACnB,wBAAyB,EAC1B,CAAC,EACD,QAAQ,SAAS,OAAO,KAAK,QAAQ,EACrC,KAAK,eAAe,EACpB,KAAK,0BAA0B,CAChC,OAAS,EAAP,CACD,QAAQ,MAAM,iCAAkC,CAAC,EACjD,KAAK,QAAU,EAChB,CACD,CAEA,QAAQ,EAAO,EAAK,EAAO,CAC1B,AAAI,CAAC,KAAK,SACV,QAAQ,QAAQ,GAAG,KAAO,IAAS,CAAK,CACzC,CAEA,SAAU,CACT,KAAK,QAAU,GACf,QAAQ,kBAAkB,CAC3B,CAEA,gBAAiB,CA5ClB,QA6CE,GAAM,GAAM,oBACN,EAAM,OAAO,SAAS,gBAAgB,EAAI,EAC1C,EAAO,aAAa,QAAQ,CAAG,EAErC,AAAI,EAAC,GAAQ,OAAO,CAAG,EAAE,KAAK,OAAO,CAAI,EAAG,OAAO,EAAI,KACtD,cAAa,QAAQ,EAAK,EAAI,YAAY,CAAC,EAC3C,KAAK,QAAQ,YAAa,SAAU,CAAE,eAAgB,aAAO,OAAP,cAAa,WAAb,cAAuB,MAAO,CAAC,EAEvF,CAEA,2BAA4B,CAC3B,AAAI,KAAK,UAAY,KAAK,SAAW,GAIrC,OAAO,OAAO,GAAG,SAAU,IAAM,CAChC,QAAQ,QAAQ,WAAW,CAC5B,CAAC,CACF,CACD,EAEA,OAAO,UAAY,GAAI,GACvB,OAAO,UAAU,WAAW",
  "names": []
}
